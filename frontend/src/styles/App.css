/* Global CSS Variables for Consistent Theming */
:root {
    /* Color Palette */
    --primary-color: #007bff;
    --primary-hover: #173983;
    --primary-focus-shadow: rgba(0, 123, 255, 0.25);
    --secondary-color: #6c757d;
    --accent-color: #096348;

    /* Background Colors - Dark Theme */
    --sidebar-bg: #1e1e2e;
    --chat-bg: #16213e;
    --input-bg: #1a1a2e;
    --input-field-bg: #2d3748;
    --hover-bg: rgba(255, 255, 255, 0.1);
    --active-bg: rgba(186, 41, 114, 0.2);

    /* Text Colors - Dark Theme */
    --text-color: #ffffff;
    --text-muted: #d0d8e0;
    --text-light: #adb5bd;
    --active-text: #95b3d3;

    /* Message Colors */
    --user-message-bg: #007bff;
    --user-message-text: #ffffff;
    --bot-message-bg: #2d3748;
    --bot-message-text: #ffffff;

    /* Border Colors - Dark Theme */
    --border-color: #2d3748;
    --border-light: #404040;

    /* Error States */
    --error-bg: #dc3545;
    --error-text: #ffffff;
    --error-border: #dc3545;

    /* Modal/Popup Colors - Dark Theme */
    --modal-bg: linear-gradient(135deg, #2d3748 0%, #1a202c 100%);
    --modal-overlay: rgba(0, 0, 0, 0.8);
    --modal-border: rgba(255, 255, 255, 0.15);
    --modal-header-bg: linear-gradient(135deg, #2d3748, #1a202c);
    
    /* Card/Container Colors */
    --card-bg: rgba(255, 255, 255, 0.05);
    --card-border: rgba(255, 255, 255, 0.1);
    --card-hover-bg: rgba(255, 255, 255, 0.08);
    
    /* Button Colors */
    --btn-primary-bg: #007bff;
    --btn-primary-hover: #0056b3;
    --btn-secondary-bg: rgba(255, 255, 255, 0.1);
    --btn-secondary-hover: rgba(255, 255, 255, 0.2);
    --btn-success-bg: #28a745;
    --btn-success-hover: #1e7e34;
    --btn-warning-bg: #ffc107;
    --btn-warning-hover: #e0a800;
    --btn-danger-bg: #dc3545;
    --btn-danger-hover: #c82333;
    
    /* Status Colors */
    --status-success-bg: rgba(40, 167, 69, 0.2);
    --status-success-text: #51cf66;
    --status-success-border: rgba(40, 167, 69, 0.3);
    --status-error-bg: rgba(220, 53, 69, 0.2);
    --status-error-text: #ff6b6b;
    --status-error-border: rgba(220, 53, 69, 0.3);
    --status-warning-bg: rgba(255, 193, 7, 0.2);
    --status-warning-text: #ffd43b;
    --status-warning-border: rgba(255, 193, 7, 0.3);
    --status-info-bg: rgba(23, 162, 184, 0.2);
    --status-info-text: #74c0fc;
    --status-info-border: rgba(23, 162, 184, 0.3);

    /* Layout */
    --sidebar-width: 320px; /* Increased from 280px */
    --header-height: 70px;
    --mobile-header-height: 60px;
    --mobile-breakpoint: 768px;
}

/* Dark Theme Support */
@media (prefers-color-scheme: dark) {
    :root {
        --sidebar-bg: #1e1e1e;
        --chat-bg: #121212;
        --input-bg: #1e1e1e;
        --input-field-bg: #2d2d2d;
        --hover-bg: #333333;
        --active-bg: #1927b6;
        --bot-message-bg: #2d2d2d;
        --border-color: #404040;
        --border-light: #333333;
    }
}

/* Main App Layout */
.app-container {
    display: flex;
    flex-direction: column;
    height: 100vh;
    overflow: hidden;
    background-color: var(--chat-bg);
}

.main-content {
    display: flex;
    flex: 1;
    min-height: 0;
    padding-top: var(--header-height);
    position: relative;
}

/* Mobile Overlay */
.mobile-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5);
    z-index: 1020; /* Below sidebar (1040), above chat (1010) */
    display: none;
    transition: opacity 0.3s ease;
}

.mobile-overlay.show {
    display: block;
    opacity: 1;
}

/* Sidebar Container */
.sidebar-container {
    width: var(--sidebar-width);
    position: fixed;
    top: var(--header-height);
    bottom: 0;
    left: 0;
    z-index: 1040; /* High z-index for mobile overlay */
    transform: translateX(-100%);
    transition: transform 0.3s ease-in-out, width 0.3s ease-in-out;
}

.sidebar-container.show {
    transform: translateX(0);
}

/* Chat Area */
.chat-area {
    flex: 1;
    display: flex;
    flex-direction: column;
    min-width: 0;
    margin-left: 0;
    transition: margin-left 0.3s ease-in-out;
}

/* Desktop Layout */
@media (min-width: 769px) {
    .sidebar-container {
        position: relative;
        transform: translateX(0);
        top: 0;
        z-index: 1010; /* Lower z-index for desktop layout */
    }

    .chat-area {
        margin-left: 0;
        transition: margin-left 0.3s ease-in-out;
    }

    .mobile-overlay {
        display: none !important;
    }

    /* Show sidebar by default on desktop but allow toggle */
    .sidebar-container.show {
        width: var(--sidebar-width);
        transform: translateX(0);
    }

    .sidebar-container:not(.show) {
        width: 0;
        transform: translateX(-100%);
        overflow: hidden; /* Hide content when collapsed */
    }

    /* Adjust chat area when sidebar is visible on desktop */
    .main-content .chat-area {
        margin-left: 0;
    }

    .main-content.sidebar-visible .chat-area {
        margin-left: var(--sidebar-width);
    }
}

/* Mobile Layout */
@media (max-width: 768px) {
    .main-content {
        padding-top: var(--mobile-header-height);
    }

    .sidebar-container {
        top: var(--mobile-header-height);
        width: 85%;
        max-width: 320px;
    }
}

/* Fix Bootstrap container padding issues */
.container-fluid {
    padding: 0 !important;
    margin: 0 !important;
}

/* Utility Classes */
.visually-hidden {
    position: absolute !important;
    width: 1px !important;
    height: 1px !important;
    padding: 0 !important;
    margin: -1px !important;
    overflow: hidden !important;
    clip: rect(0, 0, 0, 0) !important;
    white-space: nowrap !important;
    border: 0 !important;
}

/* Global Animations */
@keyframes fadeInDown {
    from {
        opacity: 0;
        transform: translateY(-10px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

@keyframes spin {
    to {
        transform: rotate(360deg);
    }
}

@keyframes pulse {
    0% {
        transform: scale(1);
        box-shadow: 0 0 0 0 rgba(220, 53, 69, 0.4);
    }
    50% {
        transform: scale(1.05);
        box-shadow: 0 0 0 8px rgba(220, 53, 69, 0.1);
    }
    100% {
        transform: scale(1);
        box-shadow: 0 0 0 0 rgba(220, 53, 69, 0);
    }
}

/* ===== GLOBAL MODAL/POPUP DARK THEME STYLES ===== */

/* All modal overlays */
.modal-backdrop,
.settings-overlay,
[class*="overlay"] {
    background: var(--modal-overlay) !important;
    backdrop-filter: blur(5px) !important;
}

/* All modal containers - less aggressive */
.modal,
.modal-dialog,
.modal-content {
    background: var(--modal-bg) !important;
    border: 1px solid var(--modal-border) !important;
    color: var(--text-color) !important;
}

/* Specific modal/popup targeting */
[class*="test-dialog"],
[class*="upload-dialog"],
[class*="auth-dialog"] {
    background: var(--modal-bg) !important;
    border: 1px solid var(--modal-border) !important;
    color: var(--text-color) !important;
}

/* Modal headers */
.modal-header,
[class*="modal-header"],
[class*="popup-header"] {
    background: var(--modal-header-bg) !important;
    border-bottom: 1px solid var(--modal-border) !important;
    color: var(--text-color) !important;
}

/* Modal bodies and content */
.modal-body,
.modal-content,
[class*="modal-body"],
[class*="popup-body"],
[class*="dialog-content"] {
    background: var(--modal-bg) !important;
    color: var(--text-color) !important;
}

/* All text in modals */
.modal h1, .modal h2, .modal h3, .modal h4, .modal h5, .modal h6,
.modal p, .modal span, .modal div, .modal label,
[class*="modal"] h1, [class*="modal"] h2, [class*="modal"] h3,
[class*="modal"] p, [class*="modal"] span, [class*="modal"] div, [class*="modal"] label,
[class*="popup"] h1, [class*="popup"] h2, [class*="popup"] h3,
[class*="popup"] p, [class*="popup"] span, [class*="popup"] div, [class*="popup"] label {
    color: var(--text-color) !important;
}

/* Muted text in modals */
.modal .text-muted,
.modal [class*="muted"],
[class*="modal"] .text-muted,
[class*="modal"] [class*="muted"],
[class*="popup"] .text-muted,
[class*="popup"] [class*="muted"] {
    color: var(--text-muted) !important;
}

/* Form elements in modals */
.modal input, .modal textarea, .modal select,
[class*="modal"] input, [class*="modal"] textarea, [class*="modal"] select,
[class*="popup"] input, [class*="popup"] textarea, [class*="popup"] select {
    background: var(--input-field-bg) !important;
    border: 1px solid var(--card-border) !important;
    color: var(--text-color) !important;
}

.modal input::placeholder, .modal textarea::placeholder,
[class*="modal"] input::placeholder, [class*="modal"] textarea::placeholder,
[class*="popup"] input::placeholder, [class*="popup"] textarea::placeholder {
    color: var(--text-light) !important;
}

/* Buttons in modals */
.modal .btn, [class*="modal"] .btn, [class*="popup"] .btn,
.modal button, [class*="modal"] button, [class*="popup"] button {
    border: 1px solid transparent !important;
    font-weight: 500 !important;
    transition: all 0.2s ease !important;
}

.modal .btn-primary, [class*="modal"] .btn-primary, [class*="popup"] .btn-primary {
    background: var(--btn-primary-bg) !important;
    border-color: var(--btn-primary-bg) !important;
    color: white !important;
}

.modal .btn-primary:hover, [class*="modal"] .btn-primary:hover, [class*="popup"] .btn-primary:hover {
    background: var(--btn-primary-hover) !important;
    border-color: var(--btn-primary-hover) !important;
}

.modal .btn-secondary, [class*="modal"] .btn-secondary, [class*="popup"] .btn-secondary {
    background: var(--btn-secondary-bg) !important;
    border-color: var(--card-border) !important;
    color: var(--text-color) !important;
}

.modal .btn-secondary:hover, [class*="modal"] .btn-secondary:hover, [class*="popup"] .btn-secondary:hover {
    background: var(--btn-secondary-hover) !important;
}

.modal .btn-success, [class*="modal"] .btn-success, [class*="popup"] .btn-success {
    background: var(--btn-success-bg) !important;
    border-color: var(--btn-success-bg) !important;
    color: white !important;
}

.modal .btn-warning, [class*="modal"] .btn-warning, [class*="popup"] .btn-warning {
    background: var(--btn-warning-bg) !important;
    border-color: var(--btn-warning-bg) !important;
    color: #212529 !important;
}

.modal .btn-danger, [class*="modal"] .btn-danger, [class*="popup"] .btn-danger {
    background: var(--btn-danger-bg) !important;
    border-color: var(--btn-danger-bg) !important;
    color: white !important;
}

/* Alert/Status messages in modals */
.modal .alert, [class*="modal"] .alert, [class*="popup"] .alert {
    border-radius: 6px !important;
    font-size: 0.9rem !important;
    margin: 1rem 0 !important;
}

.modal .alert-success, [class*="modal"] .alert-success, [class*="popup"] .alert-success {
    background: var(--status-success-bg) !important;
    color: var(--status-success-text) !important;
    border: 1px solid var(--status-success-border) !important;
}

.modal .alert-danger, [class*="modal"] .alert-danger, [class*="popup"] .alert-danger {
    background: var(--status-error-bg) !important;
    color: var(--status-error-text) !important;
    border: 1px solid var(--status-error-border) !important;
}

.modal .alert-warning, [class*="modal"] .alert-warning, [class*="popup"] .alert-warning {
    background: var(--status-warning-bg) !important;
    color: var(--status-warning-text) !important;
    border: 1px solid var(--status-warning-border) !important;
}

.modal .alert-info, [class*="modal"] .alert-info, [class*="popup"] .alert-info {
    background: var(--status-info-bg) !important;
    color: var(--status-info-text) !important;
    border: 1px solid var(--status-info-border) !important;
}

/* Code blocks in modals */
.modal pre, .modal code,
[class*="modal"] pre, [class*="modal"] code,
[class*="popup"] pre, [class*="popup"] code {
    background: rgba(0, 0, 0, 0.3) !important;
    color: var(--text-color) !important;
    border: 1px solid var(--card-border) !important;
}

/* Lists in modals */
.modal ul, .modal ol, .modal li,
[class*="modal"] ul, [class*="modal"] ol, [class*="modal"] li,
[class*="popup"] ul, [class*="popup"] ol, [class*="popup"] li {
    color: var(--text-color) !important;
}

/* Links in modals */
.modal a, [class*="modal"] a, [class*="popup"] a {
    color: #74c0fc !important;
    text-decoration: none !important;
}

.modal a:hover, [class*="modal"] a:hover, [class*="popup"] a:hover {
    color: #91d5ff !important;
    text-decoration: underline !important;
}
